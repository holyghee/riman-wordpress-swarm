/**
 * RIMAN Service Cards Mobile Slider Styles
 */

/* Slider nur auf Mobile (≤780px) aktivieren */
@media (max-width: 780px) {

  /* Full-width Slider Container */
  .riman-mobile-slider-active {
    width: 100vw !important;
    max-width: 100vw !important;
    margin-left: calc(50% - 50vw) !important;
    margin-right: calc(50% - 50vw) !important;
    position: relative;
  }

  /* Slider Container */
  .riman-mobile-slider-active .riman-service-slider-wrapper {
    position: relative !important;
    overflow: visible !important; /* Für seitliche Arrows */
    width: 100% !important;
    border-radius: 0 !important;
    display: flex !important;
    align-items: center !important;
    padding: 0 !important; /* Kein Padding hier - wird im track-container gehandhabt */
    box-sizing: border-box !important;
    min-height: 450px !important; /* Mindesthöhe für Cards */
    background: transparent !important; /* Ensure no background interference */
  }

  /* Track Container - der Haupt-Container für den Slider */
  .riman-mobile-slider-active .riman-slider-track-container {
    position: relative !important;
    flex: 1 !important;
    overflow: visible !important; /* WICHTIG: Muss visible sein für Inhalt */
    min-height: 450px !important; /* Erhöht für Card-Content */
    display: flex !important;
    align-items: center !important; /* Center cards vertically */
    width: 100% !important;
    background: transparent !important;
    padding: 20px 0 !important; /* Vertical padding für Cards */
  }

  /* Slider Track */
  .riman-mobile-slider-active .riman-service-slider-track {
    display: flex !important;
    transition: transform 0.3s ease;
    will-change: transform;
    width: 100% !important;
    min-height: 400px !important; /* Ensure track has minimum height */
    align-items: stretch !important; /* Stretch all slides */
    position: relative !important;
  }

  /* Slides */
  .riman-mobile-slider-active .riman-service-slide {
    flex: 0 0 100%;
    width: 100%;
    box-sizing: border-box;
    padding: 0 20px; /* Inneres Padding für Cards */
    /* Cards bekommen mehr Platz */
  }

  /* Service Cards im Slider */
  .riman-mobile-slider-active .riman-service-card {
    /* Card-Links deaktivieren im Slider-Modus */
    pointer-events: none;
    cursor: default;

    /* Hover-Effekte deaktivieren */
    transform: none !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05) !important;

    /* Cards behalten ihre normale Größe */
    width: 100% !important;
    max-width: none !important;
    margin: 0 !important;
  }

  .riman-mobile-slider-active .riman-service-card::after {
    border-color: rgba(182, 140, 47, 0.4) !important;
  }

  .riman-mobile-slider-active .riman-card-icon {
    transform: translateX(-50%) !important;
    box-shadow: 0 4px 16px rgba(182, 140, 47, 0.3) !important;
  }

  .riman-mobile-slider-active .riman-card-cta {
    background: transparent !important;
    color: #B68C2F !important;
  }

  /* Navigation Container - als absolute Position für Arrows */
  .riman-slider-navigation {
    position: absolute !important;
    top: 50% !important;
    left: 0 !important; /* Arrows innerhalb des Containers */
    right: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    pointer-events: none !important; /* Nur Arrows sind klickbar */
    transform: translateY(-50%) !important;
    padding: 0 40px !important; /* Padding für Arrows */
    z-index: 20 !important; /* Über dem Content */
  }

  /* Navigation Arrows - seitlich positioniert */
  .riman-slider-arrow {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: 2px solid rgba(182, 140, 47, 0.3);
    background: rgba(255, 255, 255, 0.9);
    color: #B68C2F;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
    pointer-events: auto; /* Arrows sind klickbar */
    z-index: 10;
  }

  .riman-slider-arrow:hover {
    border-color: #B68C2F;
    background: #B68C2F;
    color: white;
    transform: scale(1.1);
  }

  .riman-slider-arrow:active {
    transform: scale(0.95);
  }

  .riman-slider-arrow svg {
    width: 20px;
    height: 20px;
  }

  /* Dots Container - unten zentriert */
  .riman-slider-dots {
    position: absolute;
    bottom: -50px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    justify-content: center;
    gap: 8px;
    pointer-events: auto;
  }

  /* Backward compatibility */
  .riman-slider-nav {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 20px;
    padding: 0 16px;
  }

  .riman-slider-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: none;
    background: rgba(182, 140, 47, 0.3);
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 0;
  }

  .riman-slider-dot.active {
    background: #B68C2F;
    transform: scale(1.2);
  }

  .riman-slider-dot:hover {
    background: rgba(182, 140, 47, 0.7);
  }

  /* Touch-optimiert für bessere Swipe-Gesten */
  .riman-mobile-slider-active .riman-service-slider-track {
    touch-action: pan-y;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  /* Smooth scrolling für bessere Performance */
  .riman-service-slider-wrapper {
    -webkit-overflow-scrolling: touch;
  }

  /* Video-Handling im Slider - Updated for new video system */
  .riman-mobile-slider-active .riman-card-media video {
    pointer-events: none;
  }

  /* Mobile Slider: Keep original design intact */
  .riman-mobile-slider-active .riman-card--has-video .riman-card-media {
    /* Keep clipping mask - don't destroy design */
    overflow: hidden !important;
    position: relative !important;
  }

  /* Mobile Slider: Videos positioned within clipping mask */
  .riman-mobile-slider-active .riman-card--has-video .riman-card-video {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    z-index: 3 !important;
    /* Videos will be clipped by parent container - this preserves design */
  }

  /* Use new video classes for mobile slider */
  .riman-mobile-slider-active .riman-card-media video:not(.is-playing) {
    opacity: 0;
  }

  .riman-mobile-slider-active .riman-card-media video.is-playing {
    opacity: 1 !important;
  }

  /* Ensure video-active cards show videos */
  .riman-mobile-slider-active .riman-card--has-video.video-active video {
    opacity: 1 !important;
  }

  /* Play-Button für Videos im Slider */
  .riman-mobile-slider-active .riman-service-card.riman-card-has-video .riman-card-media::after {
    /* Play-Button in Slider-Modus ausblenden, da Cards nicht klickbar */
    display: none;
  }

  /* Responsive width bleibt voll funktionsfähig im Slider */
  .riman-mobile-slider-active.sc-responsive .riman-service-slider-wrapper {
    width: 100%;
    overflow: hidden;
    /* Respektiert alle Parent-Container Styles */
  }

  /* Slides passen sich an die Container-Breite an */
  .riman-mobile-slider-active .riman-service-slide {
    flex: 0 0 100% !important;
    width: 100% !important;
    box-sizing: border-box !important;
    padding: 0 16px !important; /* Standard Card-Padding */
    display: flex !important; /* Force flex display */
    align-items: stretch !important; /* Stretch cards to full height */
    min-height: 400px !important; /* Ensure slides have minimum height */
  }

  /* Für Vollbreite-Container: Reduziertes Padding */
  .riman-mobile-slider-active[style*="width:100vw"] .riman-service-slide,
  .riman-mobile-slider-active[style*="margin-left:calc(50% - 50vw)"] .riman-service-slide {
    padding: 0 8px;
  }

  /* Service Card nimmt die verfügbare Slide-Breite */
  .riman-mobile-slider-active .riman-service-slide .riman-service-card {
    width: 100% !important;
    max-width: none !important; /* Entfernt eventuelle width-Limitierungen */
    margin: 0 auto !important;
    display: block !important; /* Force visibility */
    opacity: 1 !important; /* Force opacity */
    visibility: visible !important; /* Force visibility */
    min-height: 350px !important; /* Ensure minimum height */
    background: rgba(255, 255, 255, 0.95) !important; /* Ensure background is visible */
    border-radius: 16px !important; /* Standard card styling */
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important; /* Standard shadow */
  }

  /* Fallback für Container ohne responsive width */
  .has-global-padding .riman-mobile-slider-active:not(.sc-responsive),
  .wp-block-post-content.is-layout-constrained .riman-mobile-slider-active:not(.sc-responsive) {
    margin-left: calc(-1 * var(--wp--style--root--padding-left, 16px));
    margin-right: calc(-1 * var(--wp--style--root--padding-right, 16px));
    width: calc(100vw - (100vw - 100%));
    max-width: calc(100vw - (100vw - 100%));
    padding-left: 0;
    padding-right: 0;
  }

  /* Animation für Slide-Wechsel */
  .riman-service-slider-track.transitioning {
    transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
  }

  /* Loading State */
  .riman-mobile-slider-active.slider-loading .riman-service-slide {
    opacity: 0.7;
  }

  .riman-mobile-slider-active.slider-loading .riman-service-slide:first-child {
    opacity: 1;
  }

  /* Video Loading Spinner */
  .riman-video-loading {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.5);
    z-index: 10;
    border-radius: inherit;
  }

  .riman-loading-spinner {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }

  .riman-spinner-circle {
    width: 24px;
    height: 24px;
    border: 2px solid rgba(182, 140, 47, 0.3);
    border-left-color: #B68C2F;
    border-radius: 50%;
    animation: riman-spin 1s linear infinite;
  }

  .riman-loading-text {
    color: white;
    font-size: 12px;
    font-weight: 500;
    text-align: center;
  }

  @keyframes riman-spin {
    to {
      transform: rotate(360deg);
    }
  }

  /* Accessibility */
  .riman-slider-dot:focus {
    outline: 2px solid #B68C2F;
    outline-offset: 2px;
  }

  /* RTL Support */
  [dir="rtl"] .riman-service-slider-track {
    direction: rtl;
  }

  [dir="rtl"] .riman-slider-nav {
    direction: ltr; /* Dots bleiben LTR */
  }

}

/* Desktop: Sicherstellen dass Slider-Styles nicht aktiv sind */
@media (min-width: 781px) {
  .riman-mobile-slider-active {
    /* Reset to normal grid layout */
  }

  .riman-service-slider-wrapper,
  .riman-service-slider-track,
  .riman-service-slide,
  .riman-slider-nav {
    display: none !important;
  }
}